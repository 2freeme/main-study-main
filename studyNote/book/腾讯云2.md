# 腾讯云2

### linux安装docker

```java
# 卸载旧版本
$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine

# 安装依赖包
$ sudo yum install -y yum-utils

# 设置镜像仓库（不推荐使用官方仓库，速度很慢）
$ sudo yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
    
# 设置镜像仓库（推荐使用阿里云仓库）
$ sudo yum-config-manager \
    --add-repo \
    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

# 更新yum软件包索引
$ sudo yum makecache fast

# 安装社区版docker
$ sudo yum install docker-ce docker-ce-cli containerd.io
# 服务方式启动
$ sudo systemctl start docker

# 查看版本
$ sudo docker version

# 测试运行容器
$ sudo docker run hello-world

# 查看下载的镜像
$ sudo docker images
    # 停止服务
$ sudo systemctl start docker

# 卸载相关依赖
$ sudo yum remove docker-ce docker-ce-cli containerd.io

# 清空工作路径
$ sudo rm -rf /var/lib/docker
```

### Docker安装es

```java
安装es
docker pull docker.elastic.co/elasticsearch/elasticsearch:7.6.2

docker run -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.elastic.co/elasticsearch/elasticsearch:7.6.2

说明：discovery.type=single-node设置为指定节点为单节点发现以便绕过ES的引导检查
docker ps 查看你的容器Id，如图

进入容器：docker exec -it {containerid} bash

修改配置文件：vi config/elasticsearch.yml
按 i 进入编辑模式，修改集群名称和节点名称
cluster.name: my-application
node.name: node-1
Esc :wq保存
Control+D退出当前容器，
docker restart {你的容器Id}

安装Kibana：步骤和ES基本一致
1：拉取镜像：
docker pull kibana:7.6.2
2：启动容器：
docker run --name kibana -p 5601:5601 -d kibana:7.6.2
3：查看容器：
docker ps
4: 访问服务器地址：
   http://{你的ip}/5601
5: 如果出现以下页面：Kibana server is not ready yet，说明Kibana没有找到ES节点，执行：docker exec -it {containerid} bash，括号中是你容器的id
执行：vi config/kibana.yml，修改你配置文件中的elasticsearch.hosts，改成你自己的服务器的ip地址，
修改完成后 esc  wq保存
Control+D退出容器
docker restart {你的容器id}
再次访问5601端口，成功！

```

